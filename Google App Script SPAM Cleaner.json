{"files":[{"id":"4a124cf0-75bc-42b1-89fb-ee4006fc9b19","name":"Code","type":"server_js","source":"var searchCriteria \u003d [\n\"goodday.website\",\n\"Logbook Loans\", \n\"gassociety.co.uk\",\n\"worldvictories.com\",\n\"BingoSpecial\",\n\"Card in association with affiliate partner\",\n\"Look at my hot nude photos\",\n\"mm1.helthnews.net\",\n\"newmessageymc.com\",\n\"BONUS! Free Under Armour Samples\",\n\"easy2shops.tech\",\n\"Latin Dating\",\n\"dailybrief@huffingtonpost.com\",\n\"Jamie with The Compensation\",\n\"freenet.newtrajet.org\",\n\"pathshopping.com\",\n\"naturalvehicle.com\",\n\"TARGETÂ® Surveys\",\n\"contact@bigboss007.net\",\n\"master.bigboss007.net\",\n\"timel4fivegrand.top\",\n\"notice.direct-shop.net\",\n\"CasinoSpecial\",\n\"select-mail.co.uk\",\n\"newdiamond.org\",\n\"master.biomedicale.net\",\n\"special-offers2017.net\",\n\"makewich17.org\",\n\"kwl8ekq5go.cu.cc\",\n\"hahhicumixair.w177.p2ninehell.top\",\n\"Top Life Insurance Carriers Offering Lower\",\n\"exclusive-bingo\",\n\n\"mail.bliver.org\"\n];\n\nfunction RunSpamCleanupScript() {\n  DeleteJunkWithouJunkLabelInSpam_IdHeaderOrContent();\n  DeleteJunkWithouJunkLabelInSpam_From();\n  DeleteJunkWithouJunkLabelInSpam_Subject();\n  DeleteJunkInTrash();\n}\n\nfunction DeleteJunkWithouJunkLabelInSpam_IdHeaderOrContent() {                       \n  for (var j \u003d 0; j \u003c searchCriteria.length; j++) {  \n    \n    var threads \u003d GmailApp.search(\"in:Spam \" + searchCriteria[j]);\n    var me \u003d Session.getActiveUser().getEmail();\n    // Logger.log(\"Found \" + threads.length + \" threads with \u0027Header ID or content:\u0027 \" + searchCriteria[j]);\n\n    for (var i \u003d threads.length -1; i \u003e\u003d0; i--) {\n      \n      var threadid\u003dthreads[i].getId();\n      // Logger.log(\"Removing thread \" +i + \u0027 of \u0027 + threads.length + \" Header ID or content: \u0027\" + searchCriteria[j] + \"\u0027 with ID \u003d \" + threadid);\n    \n      try {\n        Gmail.Users.Threads.remove(me, threadid);\n      }\n      catch(err) {\n        Logger.log(\"Error \" + err.message + \" when removing thread with ID \" + threadid);\n      };\n    }\n  }\n}\n\nfunction DeleteJunkWithouJunkLabelInSpam_From() {                       \n  for (var j \u003d 0; j \u003c searchCriteria.length; j++) {  \n    \n    var threads \u003d GmailApp.search(\"in:Spam from: \" + searchCriteria[j]);\n    var me \u003d Session.getActiveUser().getEmail();\n    // Logger.log(\"Found \" + threads.length + \" threads with \u0027from\u0027 name \" + searchCriteria[j]);\n\n    for (var i \u003d threads.length -1; i \u003e\u003d0; i--) {\n      \n      var threadid\u003dthreads[i].getId();\n      // Logger.log(\"Removing thread \" +i + \u0027 of \u0027 + threads.length + \" from \u0027\" + searchCriteria[j] + \"\u0027 with ID \u003d \" + threadid);\n    \n      try {\n        Gmail.Users.Threads.remove(me, threadid);\n      }\n      catch(err) {\n        Logger.log(\"Error \" + err.message + \" when removing thread with ID \" + threadid);\n      };\n    }\n  }\n}\n\nfunction DeleteJunkWithouJunkLabelInSpam_Subject() {                       \n  for (var j \u003d 0; j \u003c searchCriteria.length; j++) {  \n    \n    var threads \u003d GmailApp.search(\"in:Spam subject: \" + searchCriteria[j]);\n    var me \u003d Session.getActiveUser().getEmail();\n    // Logger.log(\"Found \" + threads.length + \" threads with \u0027subject\u0027 content \" + searchCriteria[j]);\n\n    for (var i \u003d threads.length -1; i \u003e\u003d0; i--) {\n      \n      var threadid\u003dthreads[i].getId();\n      // Logger.log(\"Removing thread \" +i + \u0027 of \u0027 + threads.length + \" with sujbect content \u0027\" + searchCriteria[j] + \"\u0027 with ID \u003d \" + threadid);\n    \n      try {\n        Gmail.Users.Threads.remove(me, threadid);\n      }\n      catch(err) {\n        Logger.log(\"Error \" + err.message + \" when removing thread with ID \" + threadid);\n      };\n    }\n  }\n}\n\nfunction DeleteJunkInTrash() {\n  var labelName \u003d \"Junk E-mail\";\n  \n  var threads \u003d GmailApp.search(\"in:trash label:\" + labelName);\n  var me \u003d Session.getActiveUser().getEmail();\n  // Logger.log(\"Found \" + threads.length + \" threads with \u0027label\u0027 \" + labelName);\n\n  for (var i \u003d threads.length -1; i \u003e\u003d0; i--) {\n    \n    var threadid\u003dthreads[i].getId();\n    // Logger.log(\"Removing thread \" +i + \u0027 of \u0027 + threads.length + \" from \u0027\" + labelName + \"\u0027 with ID \u003d \" + threadid);\n    \n    try {\n      Gmail.Users.Threads.remove(me, threadid);\n    }\n    catch(err) {\n      Logger.log(\"Error \" + err.message + \" when removing thread with ID \" + threadid);\n    };\n  }\n}"}]}